<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Class Management</title>
    <style>
        :root { --primary: #002147; --gold: #c5a059; --text: #1a1a1a; }

        body {
            font-family: "Segoe UI", serif;
            color: var(--text);
            margin: 0;

            /* --- UNIVERSITY BACKGROUND --- */
            /* Matching background with Live Attendance page for seamless transitions */
            background: linear-gradient(rgba(240, 244, 248, 0.92), rgba(240, 244, 248, 0.92)),
                        url('https://images.unsplash.com/photo-1523050854058-8df90110c9f1?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
        }

        .navbar {
            background: var(--primary);
            color: white;
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid var(--gold);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .nav-links a { color: rgba(255,255,255,0.7); text-decoration: none; margin-left: 20px; font-weight: 500; font-size: 14px; transition: 0.2s; }
        .nav-links a:hover { color: white; }
        .nav-links a.active { color: white; border-bottom: 2px solid var(--gold); padding-bottom: 4px; }

        .container { padding: 40px; max-width: 1400px; margin: auto; }

        .card {
            background: white;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            margin-bottom: 25px;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }

        input[type="text"], input[type="file"] { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }

        button { background: var(--primary); color: white; padding: 10px 20px; border: none; cursor: pointer; border-radius: 4px; width: 100%; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
        button:hover { opacity: 0.9; }

        h3 { margin-top: 0; color: var(--primary); font-family: Georgia, serif; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 20px; }

        label { font-size: 12px; font-weight: bold; color: #666; text-transform: uppercase; display: block; margin-bottom: 5px; }
    </style>
</head>
<body>
    <div class="navbar">
        <div style="font-size: 24px; font-family: Georgia, serif; font-weight: 700; display: flex; align-items: center; gap: 10px;">
            <span>üèõÔ∏è</span> IR!S
        </div>
        <div class="nav-links">
            <a href="/dashboard">LIVE ATTENDANCE</a>
            <a href="/manage" class="active">CLASS MANAGEMENT</a>
            <a href="/logout" style="color: #ffcccc;">Sign Out</a>
        </div>
    </div>

    <div class="container">
        <div class="card" style="border-left: 5px solid var(--gold);">
            <div style="display: flex; gap: 20px;">
                <div style="flex: 1;">
                    <form method="GET" action="/manage">
                        <label>Select Class to Manage</label>
                        <select name="class_id" onchange="this.form.submit()" style="padding: 10px; width: 100%; font-size: 16px; border-radius: 4px; border: 1px solid #ccc;">
                            <option value="" disabled selected>-- Select Class --</option>
                            {% for c in classes %}
                            <option value="{{ c.id }}" {% if selected_class and selected_class.id == c.id %}selected{% endif %}>
                                {{ c.name }} (Batch {{ c.batch }})
                            </option>
                            {% endfor %}
                        </select>
                    </form>
                </div>
                <div style="flex: 1; border-left: 1px solid #eee; padding-left: 20px;">
                    <label>Create New Class</label>
                    <form action="/add-class" method="post" style="display: flex; gap: 10px;">
                        <input type="text" name="name" placeholder="Name (e.g. CS101)" required style="margin-bottom:0;">
                        <input type="text" name="batch" placeholder="Batch" required style="margin-bottom:0;">
                        <button style="width: auto;">Create</button>
                    </form>
                </div>
            </div>
        </div>

        {% if selected_class %}
        <div class="grid">
            <div class="card">
                <h3>Register New Student</h3>
                <form action="/add-student" method="post" enctype="multipart/form-data">
                    <input type="hidden" name="class_id" value="{{ selected_class.id }}">

                    <label>Roll Number</label>
                    <input type="text" name="roll" required placeholder="e.g. 2024001">

                    <label>Full Name</label>
                    <input type="text" name="name" required placeholder="e.g. John Doe">

                    <label>Reference Photos (1-3 images)</label>
                    <input type="file" name="files" multiple required>

                    <button style="background: #2e7d32;">Add to Roster</button>
                </form>
            </div>

            <div class="card">
                <h3>Photo Verification Tool</h3>
                <p style="color: #666; font-size: 14px; line-height: 1.5;">
                    Upload a class group photo taken today. The system will scan faces in the photo and automatically mark present students in the "Live Attendance" dashboard.
                </p>
                <form action="/process-class-photo" method="post" enctype="multipart/form-data">
                    <input type="hidden" name="class_id" value="{{ selected_class.id }}">

                    <label>Upload Group Photo</label>
                    <input type="file" name="file" required>

                    <button style="background: #6610f2;">Run Verification & Go to Dashboard</button>
                </form>
            </div>
        </div>
        {% endif %}
    </div>
</body>
</html>